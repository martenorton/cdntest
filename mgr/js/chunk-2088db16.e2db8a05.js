(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2088db16"],{3856:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"screen-btn-warp"},[n("div",{staticClass:"btn-label"},[t._v(t._s(t.label)+":")]),n("div",{staticClass:"item-box"},t._l(t.dataList,(function(e,i){return n("div",{key:i,staticClass:"item",class:{active:t.is_select==i},on:{click:function(n){return t.handleClick(e.value,i)}}},[t._v("\n      "+t._s(e.label)+"\n    ")])})),0)])},a=[],s=(n("c5f6"),{props:{dataList:{type:Array,default:[]},label:{type:String,default:""},default_select:{type:Number,default:0}},data:function(){return{select_data:this.is_select||0,is_change:!1}},computed:{is_select:function(){return!this.default_select||this.is_change?this.select_data:this.default_select}},methods:{handleClick:function(t,e){this.is_change=!0,this.select_data=e,this.$emit("click",t)}},mounted:function(){}}),o=s,l=(n("8026"),n("2877")),r=Object(l["a"])(o,i,a,!1,null,"c9971672",null);e["a"]=r.exports},4878:function(t,e,n){},4882:function(t,e,n){},7585:function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}));var i=n("ed08");function a(t,e){return Object(i["a"])("/api/admin/role/list","get",t).then((function(t){t&&e&&e(t)}))}function s(t,e){return Object(i["a"])("/api/admin/role/all","get",t).then((function(t){t&&e&&e(t)}))}function o(t,e){return Object(i["a"])("/api/admin/role/info","get",t).then((function(t){t&&e&&e(t)}))}function l(t,e){return Object(i["a"])("/api/admin/role/distribute_permission","post",t).then((function(t){t&&e&&e(t)}))}function r(t,e){return Object(i["a"])("/api/admin/role/save","post",t).then((function(t){t&&e&&e(t)}))}function c(t,e){return Object(i["a"])("/api/admin/role/del","get",t).then((function(t){t&&e&&e(t)}))}},"7cbf":function(t,e,n){},8026:function(t,e,n){"use strict";var i=n("f37d"),a=n.n(i);a.a},"9f49":function(t,e,n){"use strict";var i=n("4882"),a=n.n(i);a.a},a9ac:function(t,e,n){"use strict";var i=n("4878"),a=n.n(i);a.a},aaa9:function(t,e,n){"use strict";var i=n("7cbf"),a=n.n(i);a.a},c6b7:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"novel-book-warp"},[n("div",{staticClass:"container"},[n("div",{staticClass:"head-nav"},[n("span",{staticClass:"title"},[t._v("角色权限")]),n("v-add",{attrs:{getData:t.getData}})],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table",staticStyle:{"margin-bottom":"20px"},attrs:{data:t.tableData,border:"","row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[n("el-table-column",{attrs:{prop:"id\t",label:"角色ID",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.id))])]}}])}),n("el-table-column",{attrs:{prop:"name",label:"角色名"}}),n("el-table-column",{attrs:{prop:"describe",label:"描述"}}),n("el-table-column",{attrs:{prop:"status",label:"启用状态",formatter:t.statusFormatter}}),n("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("v-addData",{staticClass:"cell-item",staticStyle:{"padding-right":"10px"},attrs:{id:e.row.id,dataSource:e.row||null,getData:t.getData}}),n("v-add",{attrs:{type:"edit",dataSource:e.row||null,getData:t.getData}})]}}])}),n("el-table-column",{attrs:{label:"删除",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("v-del",{attrs:{getData:t.getData,id:e.row.id}})]}}])})],1),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.params.pageSize||10},on:{"current-change":t.handleCurrentChange}})],1)],1)])},a=[],s=n("7585"),o=n("3dda"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"add-book-btn-warp"},[t.type?t._e():n("el-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.handleOpen()}}},[t._v("新增")]),"edit"==t.type?n("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(e){return t.handleOpen()}}},[t._v("编辑")]):t._e(),"txt"!=t.type?n("el-dialog",{attrs:{title:"edit"==t.type?"编辑":"新增","close-on-click-modal":!1,visible:t.editVisible,width:"40%"},on:{"update:visible":function(e){t.editVisible=e}}},[n("el-form",{ref:"ruleForm",staticClass:"detalis-form",attrs:{model:t.form,rules:t.rules,"label-width":"145px"}},["edit"==this.type?n("el-form-item",{attrs:{label:"角色ID",prop:"id",disabled:"true"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}})],1):t._e(),n("el-form-item",{attrs:{label:"角色名",prop:"name"}},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"描述",prop:"describe"}},[n("el-input",{model:{value:t.form.describe,callback:function(e){t.$set(t.form,"describe",e)},expression:"form.describe"}})],1),n("el-form-item",{attrs:{label:"启用状态",prop:"status"}},[n("el-select",{attrs:{placeholder:"选择启用状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[n("el-option",{key:"1",attrs:{label:"启用",value:1}}),n("el-option",{key:"2",attrs:{label:"禁用",value:0}})],1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){return t.closeBtn("ruleForm")}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确 定")])],1)],1):t._e()],1)},r=[],c=n("3856"),u={name:"basetable",components:{vUpload:o["a"],vScreen:c["a"]},props:{getData:{type:Function,default:null},type:{type:String,default:null},dataSource:{type:Object,default:null},book_id:{}},data:function(){return{editVisible:!1,loading:!1,book_path:"",typeOptions:[],attOptions:[],form:{},rules:{name:[{required:!0,message:"请填写角色名",trigger:"blur"},{pattern:/^[^\s]*$/,message:"不能输入空格"},{pattern:/^\S{1,20}$/,message:"不能多于20个字"}],describe:[{required:!0,message:"请填写描述",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}}},created:function(){},computed:{options:function(){var t=this;return this.typeOptions.filter((function(e){return e.channel==t.form.channel}))}},methods:{handleOpen:function(){this.editVisible=!0,this.form={},"edit"==this.type&&(this.form=this.dataSource)},getAttData:function(){var t=this;do_permission_save({},(function(e){t.attOptions=e.data}))},handleUploadImg:function(t){this.form.icon=t,this.form=JSON.parse(JSON.stringify(this.form))},closeBtn:function(){this.editVisible=!1,this.form,this.getData()},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;Object(s["b"])(e.form,(function(t){t.code,200==t.code&&(e.$message.success("成功"),e.getData(),e.editVisible=!1)}))}))}}},d=u,f=(n("d255"),n("2877")),p=Object(f["a"])(d,l,r,!1,null,null,null),m=p.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"del-btn-warp"},["1"!=t.id?n("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(e){return t.handleDelete()}}},[t._v("删除")]):t._e(),"1"==t.id?n("el-button",{attrs:{type:"text",icon:"el-icon-circle-close",disabled:""},on:{click:function(e){return t.handleDelete()}}},[t._v("删除")]):t._e(),n("el-dialog",{attrs:{title:"提示",visible:t.delVisible,width:"300px",center:"","close-on-click-modal":!1},on:{"update:visible":function(e){t.delVisible=e}}},[n("div",{staticClass:"del-dialog-cnt"},[t._v("删除不可恢复，是否确定删除？")]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.delVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.deleteSure}},[t._v("确 定")])],1)])],1)},h=[],g={name:"del-btn",components:{},props:{getData:{type:Function,default:null},id:{default:""}},data:function(){return{editVisible:!1,delVisible:!1,form:{}}},created:function(){},computed:{},methods:{handleDelete:function(){this.delVisible=!0},deleteSure:function(){var t=this;Object(s["a"])({id:this.id},(function(e){200==e.code&&(t.$message.success("删除成功"),t.getData()),t.delVisible=!1}))}}},v=g,k=(n("a9ac"),Object(f["a"])(v,b,h,!1,null,"70aa18c4",null)),_=k.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"permssion-btn-warp"},[n("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(e){return t.handleOpen()}}},[t._v("分发权限")]),n("el-dialog",{attrs:{title:"edit"==t.type?"编辑":"分发权限","close-on-click-modal":!1,visible:t.editVisible,width:"40%"},on:{"update:visible":function(e){t.editVisible=e}}},[n("el-form",{ref:"ruleForm",staticClass:"detalis-form",attrs:{model:t.form.check,"label-width":"145px"}},[n("el-tree",{ref:"tree",attrs:{"node-key":"id",data:t.permissionInfo,"default-checked-keys":t.checkList,props:t.defaultProps,load:t.loadNode,"show-checkbox":""},on:{"check-change":t.handleCheckChange},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){return t.closeBtn("ruleForm")}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确 定")])],1)],1)],1)},C=[],O=(n("ac6a"),n("8615"),n("d126")),D={name:"basetable",components:{},props:{getData:{type:Function,default:null},type:{type:String,default:null},dataSource:{type:Object,default:null},id:{default:""}},data:function(){return{defaultProps:{children:"son",label:"name"},checkAll:!1,checkedCities:[],isIndeterminate:!0,editVisible:!1,form:{checkAll:!1},params:{id:this.id},jurisdictionList:[],len:0,checkList:[],permissionInfo:[]}},created:function(){},mounted:function(){},methods:{getInfo:function(){var t=this;Object(s["e"])(this.params,(function(e){200==e.code&&(t.checkList=e.data.roleHasPermissions,console.log(t.checkList,"用户本身权限"))}))},loadNode:function(t,e){return 0===t.level?e([{name:"region"}]):t.level>1?e([]):void setTimeout((function(){var t=[{name:"leaf",leaf:!0},{name:"zone"}];e(t)}),500)},handleOpen:function(){this.getInfo(),this.editVisible=!0,this.form={},this.form=this.dataSource,this.getList()},getCheckedKeysa:function(){console.log(this.$refs.tree.getCheckedKeys()),this.checkList=this.$refs.tree.getCheckedKeys()},handleCheckChange:function(t,e,n){console.log(t,"data")},closeBtn:function(){this.editVisible=!1,this.form},getList:function(){var t=this;Object(O["a"])({},(function(e){200==e.code&&(t.permissionInfo=e.data,console.log(t.permissionInfo))}))},handleCheckedChange:function(t,e){console.log(t,e)},handleCheckedChanges:function(t,e){console.log(t,e)},submitForm:function(){var t=this;this.getCheckedKeysa();var e=Object.assign({},this.checkList);e=Object.values(e);var n={};n.id=e;var i=this.id;Object(s["c"])({id:i,permissions:n.id},(function(e){200==e.code&&(t.$message.success("编辑权限成功"),t.getData(),t.editVisible=!1)}))}}},j=D,w=(n("9f49"),Object(f["a"])(j,y,C,!1,null,null,null)),x=w.exports,S={name:"basetable",components:{vUpload:o["a"],vAdd:m,vDel:_,vAddData:x},data:function(){return{url:"./vuetable.json",cur_page:1,loading:!0,multipleSelection:[],del_list:[],editVisible:!1,delVisible:!1,form:{name:"",date:"",address:""},idx:-1,tableData:[],params:{page:1,pageSize:10},editId:"",typeOptions:[],total:1}},filters:{},created:function(){this.getData()},computed:{},methods:{statusFormatter:function(t,e){return 1==t.status?"启用":"禁用"},handleCurrentChange:function(t){this.params.page=t,this.getData()},getData:function(){var t=this;Object(s["f"])(this.params,(function(e){200==e.code&&(t.tableData=e.data.list,t.total=e.data.count,t.loading=!1)}))}}},V=S,$=(n("aaa9"),Object(f["a"])(V,i,a,!1,null,null,null));e["default"]=$.exports},d126:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return l}));var i=n("ed08");function a(t,e){return Object(i["a"])("/api/admin/permission/list","get",t).then((function(t){t&&e&&e(t)}))}function s(t,e){return Object(i["a"])("/api/admin/permission/save","post",t).then((function(t){t&&e&&e(t)}))}function o(t,e){return Object(i["a"])("/api/admin/permission/del","get",t).then((function(t){t&&e&&e(t)}))}function l(t,e){return Object(i["a"])("/api/admin/permission/all","get",t).then((function(t){t&&e&&e(t)}))}},d255:function(t,e,n){"use strict";var i=n("fd2b"),a=n.n(i);a.a},f37d:function(t,e,n){},fd2b:function(t,e,n){}}]);