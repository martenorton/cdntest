(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10861e0c"],{2379:function(e,t,a){},5778:function(e,t,a){"use strict";var i=a("a0d1"),n=a.n(i);n.a},"63f5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"capital-flow-warp"},[a("div",{staticClass:"container"},[a("div",{staticClass:"head-nav"},[a("span",{staticClass:"title"},[e._v("系统消息")]),a("v-add",{attrs:{getData:e.getData}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",width:"105",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"200"}}),a("el-table-column",{attrs:{prop:"content",label:"消息内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{overflow:"auto",height:"150px"}},[a("span",{domProps:{innerHTML:e._s(t.row.content)}})])]}}])}),a("el-table-column",{attrs:{prop:"sort",label:"排序"}}),a("el-table-column",{staticClass:"showHeight",attrs:{prop:"status",label:"状态",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-cell"},[1==t.row.status?a("a",{staticClass:"icon icon-show",on:{click:function(a){return e.handleEditShow(t.row,0)}}},[e._v("启用")]):e._e(),0==t.row.status?a("a",{staticClass:"icon icon-none",on:{click:function(a){return e.handleEditShow(t.row,1)}}},[e._v("禁用")]):e._e()])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("v-add",{staticClass:"cell-item",attrs:{type:"edit",id:t.row.id,dataSource:t.row||null,getData:e.getData}})]}}])}),a("el-table-column",{attrs:{label:"删除",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("v-del",{attrs:{getData:e.getData,id:t.row.id}})]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.params.pageSize||10},on:{"current-change":e.handleCurrentChange}})],1)],1)])},n=[],o=(a("7f7f"),a("ed08"));function s(e,t){return Object(o["a"])("/api/admin/system_message/list","get",e).then((function(e){e&&t&&t(e)}))}function l(e,t){return Object(o["a"])("/api/admin/system_message/save","post",e).then((function(e){e&&t&&t(e)}))}function r(e,t){return Object(o["a"])("","get",e).then((function(e){e&&t&&t(e)}))}function c(e,t){return Object(o["a"])("/api/admin/system_message/set","get",e).then((function(e){e&&t&&t(e)}))}var d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-warp"},["edit"!=e.type?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleOpen()}}},[e._v(e._s("edit"==e.type?"编辑":"新增")+"消息")]):e._e(),"edit"==e.type?a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(t){return e.handleOpen()}}},[e._v("编辑")]):e._e(),a("el-dialog",{attrs:{"before-close":e.handleClose,title:"edit"==e.type?"编辑":"新增","close-on-click-modal":!1,visible:e.editVisible,width:"40%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",staticClass:"detalis-form",attrs:{rules:e.rules,model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"消息内容",prop:"content"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.serverUrl,name:"file",headers:e.header,"show-file-list":!1,"on-success":e.uploadSuccess,"on-error":e.uploadError,"before-upload":e.beforeUpload}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}})],1),a("quill-editor",{ref:"myTextEditor",attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},[e._v(">")])],1),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{key:"1",attrs:{label:"启用",value:1}}),a("el-option",{key:"2",attrs:{label:"禁用",value:0}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeBtn("form")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("确 定")])],1)],1)],1)},u=[],p=a("3dda"),f=a("953d"),m=a("ef15"),h=(a("dda5"),a("a753"),a("8096"),a("14e1"),[["bold","italic","underline","strike"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","image"],["clean"]]),g={name:"word",components:{vUpload:p["a"],quillEditor:f["quillEditor"],quillRedefine:m["quillRedefine"]},props:{getData:{type:Function,default:null},dataSource:{type:Object,default:null},type:{type:String,default:null}},data:function(){return{editVisible:!1,form:{platform_flag:1},editorOption:{placeholder:"",theme:"snow",modules:{toolbar:{container:h,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}},serverUrl:"http://6vdapi.hzyyd.top/api/admin/common/upload",header:{},quillConfig:{placeholder:"输入消息内容"},rules:{content:[{required:!0,message:"请填写消息内容",trigger:"change"}],title:[{required:!0,message:"请填写标题",trigger:"change"},{pattern:/^[^\s]*$/,message:"不能输入空格"},{pattern:/^\S{1,20}$/,message:"不能多于20个字"}],status:[{required:!0,message:"请填写状态",trigger:"change"}],send_to:[{required:!0,message:"请填写发送人",trigger:"change"}],sort:[{required:!0,message:"请填写排序",trigger:"change"}]},img_domain:""}},created:function(){this.img_domain=localStorage.getItem("img_domain")},computed:{},methods:{onEditorChange:function(e){e.editor;var t=e.html;e.text;console.log("---内容改变事件---"),this.content=t,console.log(t)},beforeUpload:function(){this.quillUpdateImg=!0},uploadSuccess:function(e,t){var a=this.$refs.myTextEditor.quill;if(200==e.code){console.log(a.getSelection(),e.data);var i=a.getSelection().index;a.insertEmbed(i,"image","http://6vdapi.hzyyd.top"+e.data),a.setSelection(i+1)}else this.$message.error("图片插入失败");this.quillUpdateImg=!1},uploadError:function(){this.quillUpdateImg=!1,this.$message.error("图片插入失败")},handleClose:function(e){this.getData(),this.editVisible=!1},handleOpen:function(){this.dataSource&&(this.form=this.dataSource),this.editVisible=!0},handleUploadImg:function(e){this.form.thumbs=e,this.form=JSON.parse(JSON.stringify(this.form))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"edit"==t.type?l(t.form,(function(e){200==e.code&&(t.getData(),t.form={},t.$message.success("修改成功"),t.editVisible=!1),1001==e.code&&(t.editVisible=!0)})):l(t.form,(function(e){200==e.code&&(t.getData(),t.form={},t.$message.success("新增成功"),t.editVisible=!1),1001==e.code&&(t.editVisible=!0)}))}))},closeBtn:function(e){this.editVisible=!1,this.getData(),this.$refs[e].resetFields()},resetForm:function(e){this.$refs[e].resetFields()}}},b=g,v=(a("8d42"),a("2877")),y=Object(v["a"])(b,d,u,!1,null,"14310054",null),_=y.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"del-btn-warp"},[a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")]),a("el-dialog",{attrs:{title:"提示","close-on-click-modal":!1,visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteSure}},[e._v("确 定")])],1)])],1)},w=[],S={name:"del-btn",components:{},props:{getData:{type:Function,default:null},id:{default:""}},data:function(){return{editVisible:!1,delVisible:!1,form:{}}},created:function(){},computed:{},methods:{handleDelete:function(){this.delVisible=!0},deleteSure:function(){var e=this;r({id:this.id},(function(t){200==t.code&&(e.$message.success("删除成功"),e.getData()),e.delVisible=!1}))}}},q=S,x=(a("8689"),Object(v["a"])(q,k,w,!1,null,"78ae19d4",null)),C=x.exports,D={name:"capital-flow-warp",components:{vAdd:_,vDel:C},data:function(){return{url:"./vuetable.json",del_list:[],editVisible:!1,delVisible:!1,params:{page:1,pageSize:20},tableData:[],total:1,loading:!0}},created:function(){this.params.book_id=this.$route.query.book_id,this.getData()},computed:{},methods:{handleCurrentChange:function(e){this.params.page=e,this.loading=!0,this.getData()},jump:function(e,t){var a=this.$route.query.book_type;"add"==e?this.$router.push({path:"/novel/chapter_add/0",query:{book_id:this.params.book_id,channel:this.params.channel,book_type:a}}):this.$router.push({path:"/novel/chapter_add/".concat(t.id),query:{book_id:this.params.book_id,book_type:a}})},typeFormatter:function(e,t){return 1==e.send_to?"所有用户":2==e.send_to?"普通用户":"会员用户"},handleEditShow:function(e,t){var a=this;c({id:e.id,status:t},(function(e){a.$message.success("成功"),a.getData()}))},nameFormatter:function(e,t){return"".concat(e.mobile,"(").concat(e.nick_name||"未设",")")},getData:function(e){var t=this;e&&(this.params.page=1),s(this.params,(function(e){200==e.code&&(t.tableData=e.data.list,t.total=e.data.count,t.loading=!1)}))},formatter:function(e,t){return e.address},filterTag:function(e,t){return t.tag===e},handleAdd:function(e,t){this.editVisible=!0,this.form={}},handleEdit:function(e,t){if(t){this.idx=e;var a=t;this.form={name:a.name,date:a.date,address:a.address}}else this.form={};this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.delVisible=!0},saveEdit:function(){this.$set(this.tableData,this.idx,this.form),this.editVisible=!1,this.$message.success("修改第 ".concat(this.idx+1," 行成功"))},deleteRow:function(){this.tableData.splice(this.idx,1),this.$message.success("删除成功"),this.delVisible=!1}}},O=D,$=(a("5778"),Object(v["a"])(O,i,n,!1,null,null,null));t["default"]=$.exports},8689:function(e,t,a){"use strict";var i=a("e96a"),n=a.n(i);n.a},"8d42":function(e,t,a){"use strict";var i=a("2379"),n=a.n(i);n.a},a0d1:function(e,t,a){},dda5:function(e,t){e.exports={dev:{assetsSubDirectory:"static",assetsPublicPath:"/",host:"localhost",port:8088,autoOpenBrowser:!0,cssSourceMap:!0,proxyTable:{"/api":{target:"http://6vdapi.hzyyd.top",changeOrigin:!0,pathRewrite:{"^/api":"/"}},"/manager":{target:"http://6vdapi.hzyyd.top",changeOrigin:!0,pathRewrite:{"^/manager":"/"}}}}}},e96a:function(e,t,a){},ef15:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};t.quillRedefine=function(e){var t=e.placeholder||"please write here ...",a=e.theme||"snow",n=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]],o=e.toolOptions||n,s={action:"",methods:"POST",name:"img",accept:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},l=Object.assign(s,e.uploadConfig),r=e.handlers||{},c=i({},r,{image:function(){var e=this,t=this.container.querySelector("input.ql-image[type=file]");null===t&&(t=document.createElement("input"),t.setAttribute("type","file"),l.name&&t.setAttribute("name",l.name),t.setAttribute("accept",l.accept),t.classList.add("ql-image"),t.addEventListener("change",(function(){if(l.change&&l.change(a),l.size&&t.files[0].size>=1024*l.size)t.value="";else{var a=new FormData;a.append(l.name,t.files[0]),l.token&&a.append("token",l.token);var i=new XMLHttpRequest;i.open(l.methods,l.action,!0),l.header&&l.header(i,a),i.onload=function(a){if(200===i.status){var n=JSON.parse(i.responseText),o=l.res(n),s=e.quill.getSelection(!0).index;e.quill.insertEmbed(s,"image",o),e.quill.setSelection(s+1),l.success&&l.success()}t.value=""},i.upload.onloadstart=function(e){t.value="",l.start&&l.start()},i.upload.onerror=function(e){l.error&&l.error()},i.upload.onloadend=function(e){l.end&&l.end()},i.send(a)}})),this.container.appendChild(t)),t.click()}});return{placeholder:t,theme:a,modules:{toolbar:{container:o,handlers:c}}}}}}]);